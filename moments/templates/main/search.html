{% extends "base.html" %}
{% from 'bootstrap5/pagination.html' import render_pagination %}
{% import 'macros.html' as macros %}

{% block content %}
<h2>Search: {{ q }}</h2>

<ul class="nav nav-pills mb-3">
  <li class="nav-item">
    <a class="nav-link {{ 'active' if category == 'photo' else '' }}"
       href="{{ url_for('main.search', q=q, category='photo') }}">Photo</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'active' if category == 'user' else '' }}"
       href="{{ url_for('main.search', q=q, category='user') }}">User</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'active' if category == 'tag' else '' }}"
       href="{{ url_for('main.search', q=q, category='tag') }}">Tag</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'active' if category == 'ml' else '' }}"
       href="{{ url_for('main.search', q=q, category='ml') }}">AI Labels</a>
  </li>
</ul>

{% if results %}
  {% if category in ['ml', 'photo'] %}
    <div class="row row-cols-2 row-cols-md-3 g-3">
      {% for photo in results %}
        <div class="col">
          {{ macros.photo_card(photo) }}
        </div>
      {% endfor %}
    </div>
  {% elif category == 'user' %}
    <ul class="list-group">
      {% for user in results %}
        <li class="list-group-item">
          <a href="{{ url_for('user.index', username=user.username) }}">{{ user.name }}</a>
          <span class="text-muted">@{{ user.username }}</span>
        </li>
      {% endfor %}
    </ul>
  {% elif category == 'tag' %}
    <ul class="list-group">
      {% for tag in results %}
        <li class="list-group-item">
          <a href="{{ url_for('main.show_tag', tag_id=tag.id) }}">#{{ tag.name }}</a>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if pagination %}{{ render_pagination(pagination) }}{% endif %}
{% else %}
  <p>No results.</p>
{% endif %}
{% endblock %}
